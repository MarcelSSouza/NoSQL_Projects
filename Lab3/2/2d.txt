#1
cqlsh:partilhavideos> SELECT * FROM Comment_per_video WHERE video_id = 19e006d0-0d6d-11ea-9d48-0b1cc2ad2f9d  ORDER BY upload_timestamp DESC LIMIT 3;

 video_id                             | upload_timestamp                | author        | comment         | id
--------------------------------------+---------------------------------+---------------+-----------------+--------------------------------------
 19e006d0-0d6d-11ea-9d48-0b1cc2ad2f9d | 2022-11-21 22:37:09.995000+0000 | user6@bot.com |        Hello DS | 09252bb1-69ed-11ed-8b90-8b11f0cc8707
 19e006d0-0d6d-11ea-9d48-0b1cc2ad2f9d | 2022-11-21 22:37:09.974000+0000 |   ds@test.com | WHATS HAPPENING | 0921f761-69ed-11ed-8b90-8b11f0cc8707
 19e006d0-0d6d-11ea-9d48-0b1cc2ad2f9d | 2022-11-21 22:37:09.951000+0000 | user5@bot.com |        Hello DS | 091e74f1-69ed-11ed-8b90-8b11f0cc8707

(3 rows)



#2
cqlsh:partilhavideos> select tags from Video where id=08d02de0-69ed-11ed-8b90-8b11f0cc8707;

 tags
--------------------------------------------------------
 ['Greetings', 'TheFuture', 'Destroy', 'All', 'Humans']

(1 rows)

#3
cqlsh:partilhavideos> SELECT * FROM Video WHERE tags CONTAINS 'Aveiro' ALLOW FILTERING;

 id | author | upload_timestamp | description | name | tags
----+--------+------------------+-------------+------+------

(0 rows)

#4
 SELECT * FROM EVENT WHERE user='ds@test.com' AND video_id=3ffcc5a0-0d4b-11ea-9d48-0b1cc2ad2f9d ORDER BY real_timestamp DESC LIMIT
5 ;

 user        | video_id                             | real_timestamp                  | video_timestamp | action | id
-------------+--------------------------------------+---------------------------------+-----------------+--------+--------------------------------------
 ds@test.com | 3ffcc5a0-0d4b-11ea-9d48-0b1cc2ad2f9d | 2022-11-21 22:37:10.220000+0000 |             310 |   Play | 094780c1-69ed-11ed-8b90-8b11f0cc8707
 ds@test.com | 3ffcc5a0-0d4b-11ea-9d48-0b1cc2ad2f9d | 2022-11-21 22:37:10.199000+0000 |             310 |  Pause | 09444c71-69ed-11ed-8b90-8b11f0cc8707
 ds@test.com | 3ffcc5a0-0d4b-11ea-9d48-0b1cc2ad2f9d | 2022-11-21 22:37:10.184000+0000 |               0 |   Play | 09420281-69ed-11ed-8b90-8b11f0cc8707

(3 rows)

#5 
cqlsh:partilhavideos> SELECT * from Video LIMIT 10;

 id                                   | author        | upload_timestamp                | description                          | name
                                | tags
--------------------------------------+---------------+---------------------------------+--------------------------------------+------------------------------------------------------------+----------------------------------------------------------------------------
 08d02de0-69ed-11ed-8b90-8b11f0cc8707 | user4@bot.com | 2022-11-21 22:37:09.438000+0000 |                        Hello, World! |
                    Hi, Im Bot4 |                     ['Greetings', 'TheFuture', 'Destroy', 'All', 'Humans']
 08c2c060-69ed-11ed-8b90-8b11f0cc8707 |   ds@test.com | 2022-11-21 22:37:09.350000+0000 | I have made some poor life decisions | Watching some guy watch every JonTron video in one sitting | ['JonTron', 'Random', 'Why', 'Why2x', 'Gottem', 'Inception', '#intoodeep']
 08e0a8a0-69ed-11ed-8b90-8b11f0cc8707 | user9@bot.com | 2022-11-21 22:37:09.546000+0000 |                        Hello, World! |
                    Hi, Im Bot9 |                     ['Greetings', 'TheFuture', 'Destroy', 'All', 'Humans']
 08d36230-69ed-11ed-8b90-8b11f0cc8707 | user5@bot.com | 2022-11-21 22:37:09.459000+0000 |                        Hello, World! |
                    Hi, Im Bot5 |                     ['Greetings', 'TheFuture', 'Destroy', 'All', 'Humans']
 08da6710-69ed-11ed-8b90-8b11f0cc8707 | user7@bot.com | 2022-11-21 22:37:09.505000+0000 |                        Hello, World! |
                    Hi, Im Bot7 |                     ['Greetings', 'TheFuture', 'Destroy', 'All', 'Humans']
 08b68b60-69ed-11ed-8b90-8b11f0cc8707 |   ds@test.com | 2022-11-21 22:37:09.271000+0000 |                  Me going to the Zoo |
                        ZooTrip |                                 ['Wholesome', 'Cute', '#First', 'Animals']
 08c642d0-69ed-11ed-8b90-8b11f0cc8707 | user1@bot.com | 2022-11-21 22:37:09.373000+0000 |                        Hello, World! |
                    Hi, Im Bot1 |                     ['Greetings', 'TheFuture', 'Destroy', 'All', 'Humans']
 08dd7450-69ed-11ed-8b90-8b11f0cc8707 | user8@bot.com | 2022-11-21 22:37:09.525000+0000 |                        Hello, World! |
                    Hi, Im Bot8 |                     ['Greetings', 'TheFuture', 'Destroy', 'All', 'Humans']
 08c9ec50-69ed-11ed-8b90-8b11f0cc8707 | user2@bot.com | 2022-11-21 22:37:09.397000+0000 |                        Hello, World! |
                    Hi, Im Bot2 |                     ['Greetings', 'TheFuture', 'Destroy', 'All', 'Humans']
 08d732c0-69ed-11ed-8b90-8b11f0cc8707 | user6@bot.com | 2022-11-21 22:37:09.484000+0000 |                        Hello, World! |
                    Hi, Im Bot6 |                     ['Greetings', 'TheFuture', 'Destroy', 'All', 'Humans']

(10 rows)


#6
Impossivel porque Cassandra não permite Global Querying.

#7 Todos os seguidores (followers) de determinado vídeo
SELECT * FROM Follower WHERE video_id=19e006d0-0d6d-11ea-9d48-0b1cc2ad2f9d;

 user          | video_id
---------------+--------------------------------------
 user3@bot.com | 19e006d0-0d6d-11ea-9d48-0b1cc2ad2f9d
   ds@test.com | 19e006d0-0d6d-11ea-9d48-0b1cc2ad2f9d
 user9@bot.com | 19e006d0-0d6d-11ea-9d48-0b1cc2ad2f9d
 user6@bot.com | 19e006d0-0d6d-11ea-9d48-0b1cc2ad2f9d
 user5@bot.com | 19e006d0-0d6d-11ea-9d48-0b1cc2ad2f9d
 user4@bot.com | 19e006d0-0d6d-11ea-9d48-0b1cc2ad2f9d
 user8@bot.com | 19e006d0-0d6d-11ea-9d48-0b1cc2ad2f9d
 user7@bot.com | 19e006d0-0d6d-11ea-9d48-0b1cc2ad2f9d
 user2@bot.com | 19e006d0-0d6d-11ea-9d48-0b1cc2ad2f9d

(9 rows)

#8 Não Feito.


#9
Impossivel porque Cassandra não permite Global Querying.

#10
SELECT * FROM Video ORDER BY id;

#11
Como o Cassandra não permite Global Query, precisaríamos saber de antemão o nome das tags existentes e fazer a pesquisa para cada uma delas. Depois adicionar a uma lista.

#12 Todos os Followers registados

SELECT * FROM Follower;

#13 Todos os Videos que contem "'Hi, Im Bot3' " no seu nome;

cqlsh:partilhavideos> SELECT * FROM Video WHERE name= 'Hi, Im Bot3' ;

 id                                   | author        | upload_timestamp                | description   | name        | tags
--------------------------------------+---------------+---------------------------------+---------------+-------------+--------------------------------------------------------
 08ccd280-69ed-11ed-8b90-8b11f0cc8707 | user3@bot.com | 2022-11-21 22:37:09.416000+0000 | Hello, World! | Hi, Im Bot3 | ['Greetings', 'TheFuture', 'Destroy', 'All', 'Humans']

(1 rows)